mixin displayText(section)
  section.text.verticalSpacing
    h2.moduleTitle= section.title
    !{section.text}

mixin displayImage(section)
  section.image.verticalSpacing
    a(itemprop="url" href=section.url)
      picture(itemprop="image" itemscope itemtype="http://schema.org/ImageObject")
        source(srcset=section.desktop media="(min-width: 690px)")
        img(itemprop="url" src=section.mobile  alt=section.title title=section.title)
        meta(itemprop="width" content="960")
        meta(itemprop="height" content="640")

mixin displayLinks(section)
  section.links.verticalSpacing
    h2.links-headline= section.title
    ul.links-container(itemscope itemtype="https://schema.org/ItemList")
      each p,i in section.links
        li.link(itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem")
          meta(itemprop="position" content=i)
          a(itemprop="url" href=p.url)
            figure
              img(src=p.cover.link  alt=p.cover.title title=p.cover.title itemprop="image")
            h3.link-figure-title(itemprop="name")= p.title

mixin displayVideo(section)
  section.video.verticalSpacing
    .container
      .video-wrapper.video-wrapper-16x9
        iframe(src="https://www.youtube.com/embed/vrb86nqCkbY" width="560" height="349")

mixin displayQuote(section)
  section.quote
    blockquote(itemprop="description")= section.text
    .quote-info
      h3.quote-source= section.source
      h3.quote-source-info= section.source_info

extends base

block title
  block vars
  title= page.title
  
block description
  meta(name="description" content=page.description)

block canonical
  link(href="https://www.brasildefato.com.br#{page.url}" rel="canonical")
  
block keywords
  meta(name="keywords" content=page.tags)

block open_graph
  include _partial/open_graph_page
  include _partial/twitter_meta_page
  meta(property="article:tag" content=page.tags)

block header
  include _partial/menu_special

append content
  main.special
    article(itemscope itemtype="http://schema.org/NewsArticle")
      meta(itemprop="mainEntityOfPage" content="https://www.brasildefato.com.br#{page.url}")
      meta(itemprop="dateModified" content=published_at.toISOString())
      address(rel="author" itemprop="author")= page.author
      time(itemprop="datePublished" datetime=published_at.toISOString())= full_date(published_at)

      div(itemprop="publisher" itemscope itemtype="https://schema.org/Organization")
        div(itemprop="logo" itemscope itemtype="https://schema.org/ImageObject")
          meta(itemprop="url" content="https://brasildefato.com.br/img/logo-microdata.jpg")
          meta(itemprop="width" content="600")
          meta(itemprop="height" content="60")
        meta(itemprop="name" content="Brasil de Fato")
        link(itemprop="sameAs" href="https://www.brasildefato.com.br")

      figure(itemprop="image" itemscope itemtype="http://schema.org/ImageObject")
        section#cover(style="background-image: url(#{page.cover.link});")
        link(itemprop="url" href=page.cover.link)
        meta(itemprop="width" content="1200")
        meta(itemprop="height" content="800")

      section.title
        div.description
          h1.pageTitle(itemprop="headline")= page.title
          p(itemprop="description")= page.description

      div.blocks(itemprop="articleBody")
        each section in page.sections
          if section.type == 'links'
            +displayLinks(section)
          else if section.type == 'text'
            +displayText(section)
          else if section.type == 'image'
            +displayImage(section)
          else if section.type == 'video'
            +displayVideo(section)
          else if section.type == 'quote'
            +displayQuote(section)

        #share-special.share-special-top
          a.share-icon(href='https://www.facebook.com/sharer/sharer.php?u=#{config.url}#{page.url}%3Freferer=bdf_button_facebook' target='_blank' title='Compartilhe no Facebook')
            img(src="/img/social-media/share-facebook.svg" alt="Compartilhe no Facebook")
          a.share-icon(href='https://twitter.com/share?url=#{config.url}#{page.url}%3Freferer=bdf_button_twitter' target='_blank' title='Compartilhe no Twitter')
            img(src="/img/social-media/share-twitter.svg" alt="Compartilhe no Twitter")
          a.share-icon.share-mobile(href='whatsapp://send?text=#{config.url}#{page.url}%3Freferer=bdf_button_whatsapp' data-action='share/whatsapp/share' title='Compartilhe no whatsapp')
            img(src="/img/social-media/share-whatsapp.svg" alt="Compartilhe no WhatsApp")

        div.verticalSpacing
